source_directories:
    - ${HOME}

repositories:
    - path: /media/NAS/Media/Backup/Mirko/dell-eos-borg
      label: NAS

exclude_from:
    - ${XDG_CONFIG_HOME}/borgmatic/excludes

exclude_caches: true
encryption_passphrase: "{credential file .borg-passphrase}"
compression: zstd,10
archive_name_format: '{now}'
keep_within: 3m

log_file: NASBackup.log
log_file_format: '[{asctime}] {message}'
list_details: true
statistics: true

commands:
    - before: repository
      run:
          - findmnt /media/NAS/Media > /dev/null
    - after: repository
      when: [create]
      states: [finish]
      run:
          - notify-send --icon="gtk-dialog-info" "Borgmatic" "Backup to NAS completed"
    - after: error
      run:
          - notify-send --icon="gtk-dialog-warning" --urgency=critical "Borgmatic" "Backup to NAS failed"
